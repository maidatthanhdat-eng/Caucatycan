<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Câu Cá Tỷ Cân</title>

<style>
body {
  margin: 0;
  overflow: hidden;
}

/* KHUNG NHÌN */
#viewport {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  position: relative;
  background: #000;
}

/* MAP */
#game {
  width: 2000px;
  height: 1000px;
  position: absolute;
  top: 0;
  left: 0;
  background: url('map1.png') no-repeat;
  background-size: cover;
}

/* NHÂN VẬT */
#player {
  width: 50px;
  height: 50px;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  background: url('santachuoibi.jpg') center/cover no-repeat;
  pointer-events: none;
}

/* TUYẾT */
.snow {
  position: absolute;
  width: 6px;
  height: 6px;
  background: white;
  border-radius: 50%;
  opacity: 0.9;
  pointer-events: none;
}
</style>
</head>

<body>

<div id="viewport">
  <div id="game">
    <div id="player"></div>
  </div>
</div>

<script>
/* ===== SETUP ===== */
const game = document.getElementById("game");
const viewport = document.getElementById("viewport");

let pos = { x: 1000, y: 500 };
const speed = 5;
const keys = { w:false, a:false, s:false, d:false };

/* ===== INPUT ===== */
document.addEventListener("keydown", e => {
  const k = e.key.toLowerCase();
  if (k in keys) keys[k] = true;
});
document.addEventListener("keyup", e => {
  const k = e.key.toLowerCase();
  if (k in keys) keys[k] = false;
});

/* ===== TUYẾT ===== */
const snowLayer = document.createElement("div");
snowLayer.style.position = "absolute";
snowLayer.style.left = "0";
snowLayer.style.top = "0";
snowLayer.style.width = "2000px";
snowLayer.style.height = "1000px";
snowLayer.style.pointerEvents = "none";
game.appendChild(snowLayer);

const snows = [];

function createSnow() {
  const s = document.createElement("div");
  s.className = "snow";
  s.style.left = Math.random() * 2000 + "px";
  s.style.top = "-10px";

  // ❄️ RƠI NHANH + CHÉO
  s.speedY = 14 + Math.random() * 10;
  s.speedX = 7 + Math.random() * 6;

  snowLayer.appendChild(s);
  snows.push(s);
}

function updateSnow() {
  if (snows.length < 220) createSnow();

  for (let i = snows.length - 1; i >= 0; i--) {
    const s = snows[i];
    s.style.top = (s.offsetTop + s.speedY) + "px";
    s.style.left = (s.offsetLeft + s.speedX) + "px";

    if (s.offsetTop > 1000 || s.offsetLeft > 2000) {
      s.remove();
      snows.splice(i, 1);
    }
  }
}

/* ===== GAME LOOP ===== */
function update() {
  if (keys.w) pos.y += speed;
  if (keys.s) pos.y -= speed;
  if (keys.a) pos.x += speed;
  if (keys.d) pos.x -= speed;

  // GIỚI HẠN MAP
  pos.x = Math.max(0, Math.min(pos.x, 2000));
  pos.y = Math.max(0, Math.min(pos.y, 1000));

  // CAMERA
  const camX = -(pos.x - viewport.offsetWidth / 2);
  const camY = -(pos.y - viewport.offsetHeight / 2);
  game.style.transform = `translate(${camX}px, ${camY}px)`;

  updateSnow();
  requestAnimationFrame(update);
}

update();
</script>

</body>
</html>



